# Система управления отелем

Веб-приложение и десктопное приложение для управления отелем с функционалом регистрации, авторизации и бронирования номеров.

## Технологии

- **Backend**: Spring Boot 3.2.0, Spring Security, Spring Data JPA
- **База данных**: H2 (in-memory)
- **Веб-интерфейс**: Thymeleaf, Bootstrap 5
- **Десктопное приложение**: JavaFX 17
- **HTTP Client**: OkHttp

## Функционал

### Для гостей:
- Регистрация и авторизация
- Просмотр доступных номеров
- Бронирование номеров
- Просмотр истории бронирований
- Отмена бронирований
- Редактирование личной информации

### Для администраторов:
- Авторизация
- Просмотр всех номеров с информацией о бронированиях
- Добавление и удаление номеров
- Просмотр всех бронирований
- Отмена бронирований
- Просмотр списка зарегистрированных пользователей

## Запуск приложения

### 1. Запуск веб-приложения

```bash
mvn spring-boot:run
```

Или запустите класс `HotelManagementApplication` из IDE.

Веб-приложение будет доступно по адресу: http://localhost:8080

### 2. Запуск десктопного приложения

**Важно**: Десктопное приложение требует, чтобы веб-приложение было запущено, так как оно использует REST API.

#### Способ 1: Через Maven (рекомендуется)

```bash
mvn javafx:run
```

#### Способ 2: Через IDE

1. Убедитесь, что веб-приложение запущено
2. Запустите класс `DesktopApplication` из IDE
3. **Важно**: При запуске из IDE необходимо добавить VM options:
   ```
   --module-path /path/to/javafx-sdk/lib --add-modules javafx.controls,javafx.fxml
   ```
   
   Или используйте полный путь к JavaFX SDK, если он установлен отдельно.

#### Способ 3: Через командную строку с указанием модулей

```bash
java --module-path /path/to/javafx-sdk/lib --add-modules javafx.controls,javafx.fxml -cp target/classes com.hotel.desktop.DesktopApplication
```

**Примечание**: Если у вас установлен JavaFX SDK отдельно, замените `/path/to/javafx-sdk/lib` на реальный путь.

## Учетные данные по умолчанию

**Администратор:**
- Имя пользователя: `admin`
- Пароль: `admin123`

## Структура проекта

```
src/main/java/com/hotel/
├── model/              # Модели данных (User, Room, Booking)
├── repository/         # Репозитории JPA
├── service/           # Бизнес-логика
├── controller/
│   ├── api/           # REST API контроллеры
│   └── web/           # Веб-контроллеры для Thymeleaf
├── security/          # Конфигурация Spring Security
├── config/            # Конфигурационные классы
└── desktop/           # Десктопное приложение на JavaFX

src/main/resources/
├── templates/         # HTML шаблоны Thymeleaf
└── application.properties
```

## API Endpoints

### Аутентификация
- `POST /api/auth/register` - Регистрация пользователя

### Номера
- `GET /api/rooms` - Получить все номера
- `GET /api/rooms/{id}` - Получить номер по ID
- `POST /api/rooms` - Создать номер (только для админов)
- `DELETE /api/rooms/{id}` - Удалить номер (только для админов)

### Бронирования
- `POST /api/bookings` - Создать бронирование
- `GET /api/bookings/my-bookings` - Получить свои бронирования
- `DELETE /api/bookings/{id}` - Отменить бронирование
- `GET /api/bookings/available-dates` - Получить доступные даты

### Администратор
- `GET /api/admin/users` - Получить всех пользователей
- `GET /api/admin/bookings` - Получить все бронирования
- `DELETE /api/admin/bookings/{id}` - Отменить бронирование (админ)

### Пользователь
- `GET /api/user/profile` - Получить профиль
- `PUT /api/user/profile` - Обновить профиль

## Веб-интерфейс

### Страницы для гостей:
- `/login` - Вход в систему
- `/register` - Регистрация
- `/guest/dashboard` - Панель гостя (просмотр номеров, бронирование)
- `/guest/bookings` - История бронирований
- `/guest/profile` - Личный кабинет

### Страницы для администраторов:
- `/admin/dashboard` - Панель администратора
- `/admin/rooms` - Управление номерами
- `/admin/users` - Список пользователей

## Десктопное приложение

Десктопное приложение предоставляет тот же функционал, что и веб-интерфейс, но в виде нативного приложения JavaFX.

### Особенности:
- Окно входа и регистрации
- Панель администратора с вкладками:
  - Номера (просмотр, добавление, удаление)
  - Бронирования (просмотр, отмена)
  - Пользователи (просмотр списка)
- Панель гостя с вкладками:
  - Доступные номера (просмотр, бронирование)
  - Мои бронирования (просмотр, отмена)

## База данных

Приложение использует H2 in-memory базу данных. Данные сохраняются только во время работы приложения.

Для доступа к консоли H2: http://localhost:8080/h2-console
- JDBC URL: `jdbc:h2:mem:hoteldb`
- Username: `sa`
- Password: (пусто)

## Решение проблем с JavaFX

Если при запуске десктопного приложения возникает ошибка "JavaFX runtime components are missing":

1. **Убедитесь, что JavaFX зависимости загружены:**
   ```bash
   mvn clean install
   ```

2. **Используйте Maven плагин для запуска:**
   ```bash
   mvn javafx:run
   ```

3. **Если запускаете из IDE, добавьте VM options:**
   - Для IntelliJ IDEA: Run → Edit Configurations → VM options
   - Добавьте: `--module-path /path/to/javafx-sdk/lib --add-modules javafx.controls,javafx.fxml`
   
4. **Альтернативный способ - скачайте JavaFX SDK:**
   - Скачайте с https://openjfx.io/
   - Распакуйте и укажите путь в VM options

## Примечания

- Десктопное приложение требует запущенного веб-сервера
- Для работы десктопного приложения необходимо настроить аутентификацию через сессии или токены
- В текущей реализации десктопное приложение использует базовую аутентификацию через форму входа
